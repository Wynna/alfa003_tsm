////////////////////////////////////////////////////////////////////////////////
//
//  System Name : ACR Configuration File
//     Filename : acf_door_onopen
//    $Revision:: 233        $ current version of the file
//        $Date:: 2007-01-20#$ date the file was created or modified
//       Author : Ronan
//
//  Local Variable Prefix =
//
//
//  Dependencies external of nwscript:
//
//  Description
//  This script calls the ACR's OnOpen code for doors, and any custom code
//  a server may need. It is not updated in ACR updates.
//
//  Revision History
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Includes ////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

#include "acr_door_i"
#include "acr_quest_i"


////////////////////////////////////////////////////////////////////////////////
// Constants ///////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Structures //////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Global Variables ////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Prototypes /////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Definitions ////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

void main() {
    ACR_DoorOnOpen();
	
		// KiS Escort
			if((GetTag(OBJECT_SELF) == "tempus_ent")  && (GetLocalObject(GetLastOpenedBy(), "oHench") != OBJECT_INVALID))
		 	   {object oHench = GetLocalObject(GetLastOpenedBy(), "oHench");
			    object oMaster = GetLocalObject(GetLastOpenedBy(), "oMaster");
			    int iQuestState = ACR_RetrieveQuestState("kis_escort_02", oMaster);
			    AssignCommand(oMaster, RemoveHenchman(oMaster, oHench));
				AssignCommand(oHench, ActionSpeakString("I will go ahead to make ready.", TALKVOLUME_TALK));
				DestroyObject(oHench, 1.0);
				SendMessageToPC(oMaster, "The high priest goes ahead of you to prepare his altar for devotions.");
			    ACR_AddPersistentJournalQuestEntry("kis_escort_02", 3, GetLastOpenedBy(), FALSE, FALSE, FALSE, FALSE);
				
			   	}
	
}